name: build
on:
  workflow_dispatch:
  schedule: [{ cron: "0 21 * * sun" }] # Every Monday at 6am Asia/Tokyo UTC+9
jobs:
  main:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - run: sudo apt-get install -y qemu-user-static
      - run: echo -1 | sudo tee /proc/sys/fs/binfmt_misc/qemu-arm
      - run: docker login docker.pkg.github.com -u "${GITHUB_ACTOR}" -p "${{ github.token }}"
      - run: bin/build
      - run: docker-compose push
